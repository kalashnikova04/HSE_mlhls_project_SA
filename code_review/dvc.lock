schema: '2.0'
stages:
  download:
    cmd: gdown --output datasets/preprocessed_texts.csv https://drive.google.com/u/0/uc?id=1SINqrwjpJOfFxkQDzv4XzoKB3A0A0cws
    outs:
    - path: datasets/preprocessed_texts.csv
      md5: 07463b024a29177e53a4ebf568719456
      size: 216632908
  split_test:
    cmd: python train_test_splitter.py --input datasets/preprocessed_texts.csv --output_train
      datasets/train_test/train.csv --output_test datasets/train_test/test.csv --params
      params.yaml
    deps:
    - path: datasets/preprocessed_texts.csv
      md5: 07463b024a29177e53a4ebf568719456
      size: 216632908
    - path: train_test_splitter.py
      md5: 7e2854677d17520b156b545f61432c57
      size: 961
    params:
      params.yaml:
        split_test:
          random_state: 42
          test_size: 0.3
    outs:
    - path: datasets/train_test/test.csv
      md5: 99efa52fca86b89bf6e6919702ff6b7d
      size: 65472930
    - path: datasets/train_test/train.csv
      md5: 2fa3812f9b54300f7368cd5d2f0a6a0d
      size: 152486867
  split_val:
    cmd: python train_val_splitter.py --train datasets/train_test/train.csv --output_train_validate
      datasets/train_val/train.csv --output_val datasets/train_val/val.csv --params
      params.yaml
    deps:
    - path: datasets/train_test/train.csv
      md5: 2fa3812f9b54300f7368cd5d2f0a6a0d
      size: 152486867
    - path: train_val_splitter.py
      md5: 0f02be2ac2fc9b8e7de5d254b07538ae
      size: 1012
    params:
      params.yaml:
        split_val:
          random_state: 42
          test_size: 0.3
    outs:
    - path: datasets/train_val/train.csv
      md5: b9be1d70f618c6e335d1cf8c0ff45194
      size: 106742638
    - path: datasets/train_val/val.csv
      md5: 7a0537e959a75edcb7d7e0806ea67147
      size: 45744258
  objective:
    cmd: python objective_catboost.py --input_train_validate datasets/train_val/train.csv
      --input_val datasets/train_val/val.csv --test datasets/train_test/test.csv --params
      params.yaml
    deps:
    - path: datasets/train_val/train.csv
      md5: b9be1d70f618c6e335d1cf8c0ff45194
      size: 106742638
    - path: datasets/train_val/val.csv
      md5: 7a0537e959a75edcb7d7e0806ea67147
      size: 45744258
    - path: objective_catboost.py
      md5: 2dd7db7d0d4929ac59004ff194a7f8c4
      size: 2099
    params:
      params.yaml:
        catboost:
          loss_function: MultiClass
          task_type: GPU
          eval_metric: TotalF1:average=Macro
          verbose: 300
          random_seed: 42
        text_processing:
          tokenizers:
          - tokenizer_id: Sense
            separator_type: BySense
            lowercasing: 'True'
            token_types:
            - Word
            - Number
            - SentenceBreak
            sub_tokens_policy: SeveralTokens
          - tokenizer_id: Space
            separator_type: ByDelimiter
            lowercasing: 'True'
            delimiter: ' '
          dictionaries:
          - dictionary_id: BiGram
            max_dictionary_size: '50000'
            occurrence_lower_bound: '100'
            gram_order: '2'
          - dictionary_id: Word
            max_dictionary_size: '50000'
            occurrence_lower_bound: '100'
            gram_order: '1'
          - dictionary_id: 3-Gram
            max_dictionary_size: '50000'
            occurrence_lower_bound: '100'
            gram_order: '3'
          feature_processing:
            default:
            - dictionaries_names:
              - BiGram
              - Word
              - 3-Gram
              feature_calcers:
              - BoW
              tokenizers_names:
              - Space
            - dictionaries_names:
              - Word
              - BiGram
              - 3-Gram
              feature_calcers:
              - NaiveBayes
              tokenizers_names:
              - Space
  train:
    cmd: python best_model.py --input_train_validate datasets/train_val/train.csv
      --input_val datasets/train_val/val.csv --test datasets/train_test/test.csv --params
      params.yaml
    deps:
    - path: best_model.py
      md5: 957566a1223a9c8088820a1a9ca6172c
      size: 2483
    - path: datasets/train_test/test.csv
      md5: 99efa52fca86b89bf6e6919702ff6b7d
      size: 65472930
    - path: datasets/train_val/train.csv
      md5: b9be1d70f618c6e335d1cf8c0ff45194
      size: 106742638
    - path: datasets/train_val/val.csv
      md5: 7a0537e959a75edcb7d7e0806ea67147
      size: 45744258
    params:
      params.yaml:
        catboost:
          loss_function: MultiClass
          task_type: GPU
          eval_metric: TotalF1:average=Macro
          verbose: 300
          random_seed: 42
    outs:
    - path: catboost_info
      md5: c4c1df7522eee2bf27ff9e7e0ae7f253.dir
      size: 1527041
      nfiles: 6
    - path: metrics.json
      md5: d1bcc79490e7a5270c8216996b46408c
      size: 150
